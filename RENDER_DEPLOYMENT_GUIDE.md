# SmartBet Deployment Guide - Render (Full Stack) ðŸš€

Complete guide to deploy both **Frontend** and **Backend** on Render.

**âœ¨ No timeout limits for API processing!**

---

## ðŸ“‹ Why Render for Everything?

âœ… **No timeout limits** - Perfect for long-running API requests  
âœ… **Single platform** - Manage everything in one place  
âœ… **Simple pricing** - Clear, predictable costs  
âœ… **Auto-scaling** - Handles traffic spikes  
âœ… **Zero-config SSL** - HTTPS automatic  
âœ… **Git-based deploys** - Auto-deploy on push  

---

## ðŸ’° Cost Breakdown

### FREE Tier (Perfect for Testing)
- Backend: FREE (sleeps after 15 min inactivity)
- Frontend: FREE (sleeps after 15 min inactivity)
- Database: FREE (90-day expiration, 1GB storage)
- **Total: $0/month** âœ¨

### Recommended Production Setup
- Backend (Starter): **$7/month** (always-on, 512MB RAM)
- Frontend (Starter): **$7/month** (always-on, 512MB RAM)
- Database (Starter): **$7/month** (persistent, 1GB storage)
- **Total: $21/month** ðŸ’µ

---

## ðŸŽ¯ Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           RENDER PLATFORM              â”‚
â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Frontend   â”‚â”€â”€â”€â–¶â”‚   Backend    â”‚ â”‚
â”‚  â”‚   (Next.js)  â”‚API â”‚   (Django)   â”‚ â”‚
â”‚  â”‚              â”‚    â”‚              â”‚ â”‚
â”‚  â”‚ Port: 3000   â”‚    â”‚ Port: 10000  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚         â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                      â”‚  PostgreSQL   â”‚ â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“¦ Prerequisites

Before deploying:

1. âœ… GitHub account with code pushed
2. âœ… Render account (https://render.com) - FREE to create
3. âœ… SportMonks API token (https://www.sportmonks.com)

---

## ðŸš€ Part 1: Push Code to GitHub

Make sure all your code is committed and pushed:

```bash
git add .
git commit -m "Ready for Render deployment - full stack"
git push origin main
```

---

## ðŸ”§ Part 2: Deploy Everything with Blueprint

### Step 1: Create Render Account

1. Go to https://render.com
2. Click **"Get Started"** or **"Sign Up"**
3. Choose **"Sign up with GitHub"** (recommended for easier integration)
4. Authorize Render to access your GitHub repositories

### Step 2: Deploy Using Blueprint

1. In Render dashboard, click **"New +"** in top right
2. Select **"Blueprint"**
3. Connect your GitHub repository (if not already connected)
4. Select your **`smartbet`** repository
5. Render will automatically detect the `render.yaml` file

### Step 3: Configure Services

Render will create 3 services based on `render.yaml`:

1. **smartbet-backend** (Django API)
2. **smartbet-frontend** (Next.js)
3. **smartbet-db** (PostgreSQL)

### Step 4: Set Environment Variables

Before deploying, set these environment variables:

#### Backend Environment Variables

Click on **smartbet-backend** â†’ **Environment** tab:

**Required:**
- `DEBUG` = `False` âœ… (already set by render.yaml)
- `DJANGO_SECRET_KEY` = âœ… (auto-generated by Render)
- `DATABASE_URL` = âœ… (auto-configured)
- `SPORTMONKS_TOKEN` = `your-api-token-from-sportmonks` âš ï¸ **YOU MUST SET THIS**
- `SPORTMONKS_API_TOKEN` = `your-api-token-from-sportmonks` âš ï¸ **YOU MUST SET THIS**
- `ALLOWED_HOSTS` = Leave blank for now (we'll update after deployment)
- `FRONTEND_URL` = Leave blank for now (we'll update after deployment)

#### Frontend Environment Variables

Click on **smartbet-frontend** â†’ **Environment** tab:

**Required:**
- `NEXT_PUBLIC_API_URL` = Leave blank for now (we'll update after backend deploys)
- `NODE_VERSION` = `20.11.0` âœ… (already set by render.yaml)

### Step 5: Deploy!

1. Click **"Apply"** at the bottom of the Blueprint setup
2. Render will start deploying all services
3. **Wait 10-15 minutes** for first deployment:
   - Database provisioning: ~2 minutes
   - Backend build: ~5-8 minutes
   - Frontend build: ~3-5 minutes

You can monitor progress in the **"Events"** tab of each service.

---

## ðŸ”— Part 3: Connect Frontend & Backend

After deployment completes, you'll have 3 URLs. Now we need to connect them.

### Step 1: Get Your URLs

Note down these URLs (find them in each service's page):

1. **Backend URL:** `https://smartbet-backend-XXXXX.onrender.com`
2. **Frontend URL:** `https://smartbet-frontend-XXXXX.onrender.com`

### Step 2: Update Backend Environment Variables

Go to **smartbet-backend** â†’ **Environment** tab:

Update/Add:
- `FRONTEND_URL` = `https://smartbet-frontend-XXXXX.onrender.com`
- `ALLOWED_HOSTS` = `smartbet-backend-XXXXX.onrender.com,smartbet-frontend-XXXXX.onrender.com`

Click **"Save Changes"** â†’ Backend will redeploy (~2 minutes)

### Step 3: Update Frontend Environment Variables

Go to **smartbet-frontend** â†’ **Environment** tab:

Update/Add:
- `NEXT_PUBLIC_API_URL` = `https://smartbet-backend-XXXXX.onrender.com`

Click **"Save Changes"** â†’ Frontend will redeploy (~2 minutes)

---

## âœ… Part 4: Verify Deployment

### Test Backend Health

Visit: `https://smartbet-backend-XXXXX.onrender.com/api/health/`

âœ… **Expected Response:**
```json
{"status": "healthy", "service": "smartbet-backend"}
```

### Test Frontend

Visit: `https://smartbet-frontend-XXXXX.onrender.com`

âœ… **Expected:** Homepage loads successfully

### Test Integration

1. Open browser DevTools (F12)
2. Go to **Console** tab
3. Visit your frontend
4. Check for:
   - âœ… No CORS errors
   - âœ… Predictions loading
   - âœ… API calls succeeding

---

## ðŸ” Part 5: Create Admin User

To access Django admin panel:

1. Go to Render dashboard â†’ **smartbet-backend**
2. Click **"Shell"** tab (right side)
3. Wait for shell to connect
4. Run:
   ```bash
   python manage.py createsuperuser
   ```
5. Enter:
   - Username: `admin`
   - Email: `your-email@example.com`
   - Password: (choose a strong password)
   - Confirm password

6. Test admin access:
   `https://smartbet-backend-XXXXX.onrender.com/admin/`

---

## ðŸŽ‰ Deployment Complete!

**Your Live URLs:**

- ðŸŒ **Frontend:** `https://smartbet-frontend-XXXXX.onrender.com`
- ðŸ”§ **Backend API:** `https://smartbet-backend-XXXXX.onrender.com`
- ðŸ‘¤ **Admin Panel:** `https://smartbet-backend-XXXXX.onrender.com/admin/`

---

## âš™ï¸ Post-Deployment Configuration

### Enable Auto-Deploy (Optional)

By default, Render auto-deploys on every push to `main` branch.

To change:
1. Go to service â†’ **Settings** â†’ **Build & Deploy**
2. Toggle **"Auto-Deploy"**

### Upgrade to Paid Tier (Recommended)

For production, upgrade to avoid services sleeping:

1. Go to each service â†’ **Settings** â†’ **Pricing**
2. Select **"Starter"** plan ($7/month per service)
3. Confirm upgrade

**Benefits:**
- âœ… Always-on (no sleep)
- âœ… Better performance
- âœ… More resources

---

## ðŸ› Troubleshooting

### Backend Won't Start

**Check Logs:**
1. Go to **smartbet-backend** â†’ **Logs** tab
2. Look for errors

**Common Issues:**
- Missing `SPORTMONKS_TOKEN` environment variable
- Database connection issues (check `DATABASE_URL`)
- Migration errors (check build logs)

**Solution:**
- Verify all environment variables are set
- Try manual deploy: Click **"Manual Deploy"** â†’ **"Clear build cache & deploy"**

---

### Frontend Won't Start

**Check Logs:**
1. Go to **smartbet-frontend** â†’ **Logs** tab

**Common Issues:**
- Missing `NEXT_PUBLIC_API_URL`
- Build errors (npm dependencies)

**Solution:**
- Verify `NEXT_PUBLIC_API_URL` is set correctly
- Check build logs for specific error messages

---

### CORS Errors

**Symptoms:**
- Browser console shows: "Access to fetch... has been blocked by CORS policy"

**Solution:**
1. Go to **smartbet-backend** â†’ **Environment**
2. Verify `FRONTEND_URL` matches your frontend URL exactly
3. Verify `ALLOWED_HOSTS` includes both backend and frontend domains
4. Save and redeploy

---

### API Requests Timeout

**Note:** With Render web services, there's **no timeout limit** for API requests! However:

- Free tier services sleep after 15 min of inactivity
- First request after sleep takes ~30 seconds to wake up

**Solution:**
- Upgrade to Starter plan ($7/mo) for always-on
- OR use a service like UptimeRobot to ping your services every 5 minutes

---

### Database Connection Errors

**Solution:**
1. Verify database is running: Check **smartbet-db** status
2. Verify `DATABASE_URL` is set in backend environment
3. Try running migrations manually:
   - Go to backend â†’ **Shell**
   - Run: `python manage.py migrate`

---

## ðŸ”„ Updating Your Deployment

### Backend Updates

```bash
# Make changes to backend code
git add .
git commit -m "Update backend"
git push origin main
```

Render automatically deploys backend within 2-5 minutes.

### Frontend Updates

```bash
# Make changes to frontend code
git add .
git commit -m "Update frontend"
git push origin main
```

Render automatically deploys frontend within 2-5 minutes.

### Manual Deployment

If auto-deploy is disabled:
1. Go to service in Render dashboard
2. Click **"Manual Deploy"**
3. Select **"Deploy latest commit"**

---

## ðŸ“Š Monitoring

### View Logs

**Real-time Logs:**
1. Go to service â†’ **Logs** tab
2. Filter by severity (Info, Warning, Error)

**Download Logs:**
1. Logs tab â†’ Click download icon
2. Get last 10,000 lines

### Monitor Performance

**Metrics:**
1. Go to service â†’ **Metrics** tab
2. View:
   - CPU usage
   - Memory usage
   - Request count
   - Response times

### Set Up Alerts

1. Service â†’ **Settings** â†’ **Alerts**
2. Configure:
   - Deploy failure notifications
   - Service down notifications
   - Email or Slack alerts

---

## ðŸŽ“ Advanced Configuration

### Custom Domains

**Add Custom Domain:**
1. Go to service â†’ **Settings** â†’ **Custom Domains**
2. Click **"Add Custom Domain"**
3. Enter your domain (e.g., `app.yourdomain.com`)
4. Follow DNS configuration instructions
5. Render provides free SSL certificate

**Update CORS:**
After adding custom domain, update backend:
- `ALLOWED_HOSTS` â†’ Add custom domains
- `FRONTEND_URL` â†’ Update if frontend has custom domain

### Environment-Specific Deployments

**Create Staging Environment:**
1. Create `develop` branch in GitHub
2. In Render, create new Blueprint from `develop` branch
3. Configure separate environment variables
4. Now you have:
   - `main` branch â†’ Production
   - `develop` branch â†’ Staging

### Scheduled Jobs (Cron)

For automated tasks:

1. Render dashboard â†’ **New +** â†’ **Cron Job**
2. Configure:
   - Name: `update-predictions`
   - Command: `python manage.py update_results`
   - Schedule: `0 */6 * * *` (every 6 hours)
3. Connect to same database

---

## ðŸ“ˆ Scaling

### Vertical Scaling (More Resources)

Upgrade plan for more power:
- **Starter:** 512MB RAM - $7/month
- **Standard:** 2GB RAM - $25/month
- **Pro:** 4GB RAM - $85/month

### Horizontal Scaling (More Instances)

For high traffic:
1. Service â†’ **Settings** â†’ **Scaling**
2. Increase number of instances
3. Load balancing is automatic

---

## ðŸ”’ Security Checklist

Before going live:

- [ ] `DEBUG = False` in production âœ…
- [ ] Strong Django admin password âœ…
- [ ] Environment variables properly set âœ…
- [ ] CORS configured correctly âœ…
- [ ] HTTPS enabled (automatic) âœ…
- [ ] Database backups enabled
- [ ] Access logs monitored
- [ ] Strong database password

---

## ðŸ’¾ Backup Strategy

### Database Backups

**Manual Backup:**
1. Backend Shell: `python manage.py dumpdata > backup.json`
2. Download via SFTP or store in cloud storage

**Automated Backups (Paid Plans):**
- Available on database Starter plan ($7/mo)
- Daily automated backups
- Point-in-time recovery

---

## ðŸ†˜ Support Resources

**Render Documentation:**
- Render Docs: https://render.com/docs
- Python/Django Guide: https://render.com/docs/deploy-django
- Node.js Guide: https://render.com/docs/deploy-node

**Your Documentation:**
- Environment variables: See `env.example` and `frontend/env.example`
- Architecture: See `DEPLOYMENT_SUMMARY.md`

**Platform Support:**
- Render Community: https://community.render.com
- Support Email: support@render.com
- Status Page: https://status.render.com

---

## ðŸŽ¯ Next Steps

After successful deployment:

1. **Test Thoroughly**
   - Test all features
   - Check different browsers
   - Test on mobile devices

2. **Monitor for 24-48 Hours**
   - Check logs regularly
   - Monitor error rates
   - Track performance metrics

3. **Optimize Performance**
   - Enable caching if needed
   - Optimize database queries
   - Monitor API response times

4. **Set Up Monitoring**
   - UptimeRobot for uptime monitoring
   - Sentry for error tracking
   - Google Analytics for usage

5. **Plan for Growth**
   - Monitor resource usage
   - Plan scaling strategy
   - Set up staging environment

---

## âœ… Success!

Your SmartBet platform is now live with:

- âœ… No timeout limits for API processing
- âœ… Both frontend and backend on same platform
- âœ… Automatic HTTPS
- âœ… Auto-deploy on git push
- âœ… PostgreSQL database
- âœ… Health monitoring
- âœ… Easy scaling

**Congratulations on your deployment! ðŸŽ‰**

---

**Questions or issues?**  
Check the troubleshooting section or Render documentation.

Good luck! ðŸš€

